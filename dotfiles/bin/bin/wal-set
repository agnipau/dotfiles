#!/usr/bin/env bash
#
# Script executed by pywal.

# shellcheck source=/dev/null
. "${HOME}/.cache/wal/colors.sh"

reload_dunst() {
  pkill dunst
  dunst \
    -lb "${color0:-#000000}" \
    -nb "${color0:-#000000}" \
    -cb "${color1:-#ff0000}" \
    -lf "${color7:-#ffffff}" \
    -nf "${color7:-#ffffff}" \
    -cf "${color0:-#000000}" \
    -lfr "${color0:-#000000}" \
    -nfr "${color0:-#000000}" \
    -cfr "${color1:-#ff0000}"
}

reload_zathura() {
  cat <<EOF >"${HOME}/.cache/wal/colors-zathura"
set default-bg "${color0:-#000000}"
set default-fg "${color7:-#ffffff}"
set completion-bg "${color0:-#000000}"
set completion-fg "${color7:-#ffffff}"
set completion-highlight-bg "${color1:-#ff0000}"
set completion-highlight-fg "${color0:-#000000}"
set statusbar-bg "${color1:-#ff0000}"
set statusbar-fg "${color0:-#000000}"
set inputbar-bg "${color0:-#000000}"
set inputbar-fg "${color7:-#ffffff}"
EOF
}

reload_openbox() {
  sed -i --follow-symlinks \
      -e "s/bg.color: #.*/bg.color: ${color0:-#000000}/" \
      -e "s/text.color: #.*/text.color: ${color7:-#ffffff}/" \
      -e "s/image.color: #.*/image.color: ${color7:-#ffffff}/" \
      "${HOME}/.themes/Agnipau/openbox-3/themerc"
  openbox --reconfigure
}

reload_telegram() {
  pkill telegram
  "${HOME}/.wal-telegram/tgen"
  telegram-desktop
}

reload_polybar() {
  sed -i --follow-symlinks \
      -e "s/^color0 = #.*/color0 = ${color0:-#000000}/" \
      -e "s/^color1 = #.*/color1 = ${color1:-#ffffff}/" \
      -e "s/^color2 = #.*/color2 = ${color2:-#ffffff}/" \
      -e "s/^color3 = #.*/color3 = ${color3:-#ffffff}/" \
      -e "s/^color4 = #.*/color4 = ${color4:-#ffffff}/" \
      -e "s/^color5 = #.*/color5 = ${color5:-#ffffff}/" \
      -e "s/^color6 = #.*/color6 = ${color6:-#ffffff}/" \
      -e "s/^color7 = #.*/color7 = ${color7:-#ffffff}/" \
      -e "s/^color8 = #.*/color8 = ${color8:-#ffffff}/" \
      -e "s/^color9 = #.*/color9 = ${color9:-#ffffff}/" \
      -e "s/^color10 = #.*/color10 = ${color10:-#ffffff}/" \
      -e "s/^color11 = #.*/color11 = ${color11:-#ffffff}/" \
      -e "s/^color12 = #.*/color12 = ${color12:-#ffffff}/" \
      -e "s/^color13 = #.*/color13 = ${color13:-#ffffff}/" \
      -e "s/^color14 = #.*/color14 = ${color14:-#ffffff}/" \
      -e "s/^color15 = #.*/color15 = ${color15:-#ffffff}/" \
      "${HOME}/.config/polybar/config"
}

main() {
  reload_dunst &
  reload_zathura &
  reload_openbox &
  reload_telegram &
  xrdb -load "${HOME}/.Xresources"
}
main
