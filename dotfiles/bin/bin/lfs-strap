#!/usr/bin/env bash
#
# Download all the updated LFS resources and make an archive out of them.

olddir="$PWD"
tmpdir="$(mktemp -d)"
cd "$tmpdir" || exit 1

# lfs.
wget -mkEpnp http://www.linuxfromscratch.org/lfs/downloads/stable/
rm -f www.linuxfromscratch.org/lfs/downloads/stable/index*
mkdir lfs
mv www.linuxfromscratch.org/lfs/downloads/stable/* lfs

# blfs.
wget -mkEpnp http://www.linuxfromscratch.org/blfs/downloads/stable/
rm -f www.linuxfromscratch.org/blfs/downloads/stable/index*
mkdir blfs
mv www.linuxfromscratch.org/blfs/downloads/stable/* blfs

# jhalfs.
wget -mkEpnp http://www.linuxfromscratch.org/alfs/downloads/jhalfs/stable/
rm -f www.linuxfromscratch.org/alfs/downloads/jhalfs/stable/index*
mkdir jhalfs
mv www.linuxfromscratch.org/alfs/downloads/jhalfs/stable/* jhalfs

# hints.
wget -mkEpnp http://www.linuxfromscratch.org/hints/downloads/files/
rm -f www.linuxfromscratch.org/hints/downloads/files/index*
mkdir hints
mv www.linuxfromscratch.org/hints/downloads/files/* hints

# patches.
wget -mkEpnp http://www.linuxfromscratch.org/patches/downloads/
rm -f www.linuxfromscratch.org/patches/downloads/index*
mkdir patches
mv www.linuxfromscratch.org/patches/downloads/* patches

# Create an archive out of the downloaded resources.
tar -cvzf lfs.tar.gz lfs blfs jhalfs hints patches
mv lfs.tar.gz "$olddir"
cd "$olddir" || exit 1 
rm -rf "$tmpdir"
