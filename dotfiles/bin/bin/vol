#!/usr/bin/env bash
#
# Control alsa controllers volues.

set -x

# shellcheck source=/dev/null
. "${HOME}/.local/share/icons-in-terminal/icons_bash.sh"

cvo_gre="$(amixer sget Master | tail -n1 | cut -d' ' -f6)"
cvo="${cvo_gre:1:3}"

if [[ "${cvo:2}" = % ]]; then
  cvo="${cvo:0:2}"
elif [[ "${cvo:2}" = 0 ]]; then
  cvo="${cvo:0:3}"
else
  cvo="${cvo:0:1}"
fi

# shellcheck disable=SC2059,2154,1117
if [[ "$cvo" -ge 50 ]]; then
  ico="$(printf "$fa_volume_up\n")"
elif [[ "$cvo" -gt 0 ]]; then
  ico="$(printf "$fa_volume_down\n")"
elif [[ "$cvo" -eq 0 ]]; then
  ico="$(printf "$fa_volume_off\n")"
fi

[[ "$1" == --current ]] && notify-send -t 1000 "${ico} ${cvo}%"
[[ "$1" == --volup ]] && amixer sset Master 5%+
[[ "$1" == --voldown ]] && amixer sset Master 5%-
[[ "$1" == --toggle ]] && amixer sset Master toggle
[[ "$1" == --mute ]] && amixer sset Master mute
[[ "$1" == --unmute ]] && amixer sset Master unmute
[[ "$1" == --max ]] && amixer sset Master 100%
[[ "$1" == --min ]] && amixer sset Master 0%
